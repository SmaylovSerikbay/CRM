import pandas as pd

# Создаем тестовый файл Excel с правильной структурой
data = {
    'СПИСОК лиц, подлежащих обязательному медицинскому осмотру': [''],
    'согласно приказу Министра здравоохранения Республики Казахстан от 28 августа 2020 года № ҚР ДСМ-131/2020': [''],
}

# Создаем DataFrame с заголовками
df_header = pd.DataFrame(data)

# Создаем данные сотрудников
employee_data = {
    '№ п/п': [1, 2],
    'ФИО': ['Тестов Тест Тестович', 'Иванов Иван Иванович'],
    'Дата рождения': ['01.01.1990', '02.02.1985'],
    'Пол': ['Мужской', 'Мужской'],
    'Объект или участок': ['Тестовый участок', 'Основной участок'],
    'Занимаемая должность': ['Тестовая должность', 'Инженер'],
    'Общий стаж': [5, 10],
    'Стаж по занимаемой должности': [3, 8],
    'Дата последнего медосмотра': ['01.01.2023', '01.01.2022'],
    'Профессиональная вредность': ['п.14 «Работа на ПК»', 'п.1 «Работы, связанные с воздействием химических факторов»'],
    'Примечание': ['Тест', 'Основной работник']
}

df_employees = pd.DataFrame(employee_data)

# Сохраняем в Excel файл
with pd.ExcelWriter('test_contingent.xlsx', engine='openpyxl') as writer:
    # Записываем заголовок
    df_header.to_excel(writer, sheet_name='Sheet1', index=False, header=False, startrow=0)
    # Записываем данные сотрудников
    df_employees.to_excel(writer, sheet_name='Sheet1', index=False, startrow=3)

print("Тестовый файл test_contingent.xlsx создан")