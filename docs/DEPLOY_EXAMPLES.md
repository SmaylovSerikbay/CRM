# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

## –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH (–æ–¥–∏–Ω —Ä–∞–∑)

**Windows:**
```cmd
setup-ssh.bat
```

**Linux/Mac:**
```bash
ssh-keygen -t rsa -b 4096
ssh-copy-id ubuntu@82.115.48.40
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh ubuntu@82.115.48.40

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
cd /root
git clone https://github.com/–≤–∞—à-username/crm-medical.git crm-medical
cd crm-medical

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cp .env.prod .env
nano .env

# –ò–∑–º–µ–Ω–∏—Ç—å –≤ .env:
# - POSTGRES_PASSWORD
# - SECRET_KEY
# - ALLOWED_HOSTS
# - GREEN_API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

# –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
docker compose -f docker-compose.yml build
docker compose -f docker-compose.yml up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
docker compose ps
docker compose logs
```

### –®–∞–≥ 3: –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π

**Windows:**
```cmd
deploy.bat "–ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π"
```

**Linux/Mac:**
```bash
make deploy
```

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 2: –û–±—ã—á–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –£—Ç—Ä–æ–º: –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã

```bash
# –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
make dev

# –ò–ª–∏ –Ω–∞ Windows
docker-compose -f docker-compose.dev.yml up
```

### –í —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è: –í–Ω–µ—Å–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

1. –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç–µ –∫–æ–¥
2. –¢–µ—Å—Ç–∏—Ä—É–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ
3. –ö–æ–≥–¥–∞ –≥–æ—Ç–æ–≤–æ - –¥–µ–ø–ª–æ–∏—Ç–µ

**Windows:**
```cmd
deploy-quick.bat "–î–æ–±–∞–≤–∏–ª —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"
```

**Linux/Mac:**
```bash
make deploy-quick
```

### –í–µ—á–µ—Ä–æ–º: –ü—Ä–æ–≤–µ—Ä–∫–∞

```cmd
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
server-logs.bat

# –ò–ª–∏
make server-logs
```

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°—Ä–æ—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ù–∞—à–ª–∏ –±–∞–≥ –Ω–∞ –ø—Ä–æ–¥–µ

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:**
   ```bash
   # –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥
   nano frontend/app/page.tsx
   ```

2. **–ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π:**
   ```cmd
   deploy-quick.bat "–ò—Å–ø—Ä–∞–≤–∏–ª –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥"
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
   - –û—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –±–∞–≥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω

4. **–ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:**
   ```cmd
   server-logs.bat
   ```

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –î–æ–±–∞–≤–∏–ª–∏ –Ω–æ–≤—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É

1. **–û–±–Ω–æ–≤–∏—Ç—å package.json –∏–ª–∏ requirements.txt:**
   ```bash
   cd frontend
   npm install –Ω–æ–≤–∞—è-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞
   ```

2. **–ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π —Å rebuild:**
   ```cmd
   deploy.bat "–î–æ–±–∞–≤–∏–ª –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤"
   ```

   ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `deploy.bat`, –∞ –Ω–µ `deploy-quick.bat`, —Ç–∞–∫ –∫–∞–∫ –Ω—É–∂–µ–Ω rebuild!

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 5: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ù—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ –ø—Ä–æ–¥–µ

1. **–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É:**
   ```cmd
   server-connect.bat
   ```

2. **–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```bash
   cd /home/ubuntu/projects/CRM
   nano .env
   # –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
   
   # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
   docker compose restart
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
   ```bash
   docker compose logs
   ```

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 6: –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–ø–ª–æ–π —Å–ª–æ–º–∞–ª –ø—Ä–æ–¥

1. **–û—Ç–∫–∞—Ç–∏—Ç—å git:**
   ```bash
   git log  # –ù–∞–π—Ç–∏ —Ö–æ—Ä–æ—à–∏–π –∫–æ–º–º–∏—Ç
   git reset --hard –•–û–†–û–®–ò–ô_–ö–û–ú–ú–ò–¢_HASH
   git push -f origin main
   ```

2. **–û–±–Ω–æ–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```cmd
   deploy.bat "–û—Ç–∫–∞—Ç –∫ —Ä–∞–±–æ—á–µ–π –≤–µ—Ä—Å–∏–∏"
   ```

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

### –•–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**Windows:**
```cmd
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
server-connect.bat

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd /home/ubuntu/projects/CRM
docker compose ps
docker compose logs --tail=50
```

**Linux/Mac:**
```bash
make server-status
make server-logs
```

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 8: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Docker –æ–±—Ä–∞–∑–æ–≤

### –í—ã—à–ª–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è Node.js –∏–ª–∏ Python

1. **–û–±–Ω–æ–≤–∏—Ç—å Dockerfile:**
   ```dockerfile
   # frontend/Dockerfile
   FROM node:20-alpine  # –±—ã–ª–æ 18
   ```

2. **–ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π:**
   ```cmd
   deploy.bat "–û–±–Ω–æ–≤–∏–ª Node.js –¥–æ –≤–µ—Ä—Å–∏–∏ 20"
   ```

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 9: –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ò–∑–º–µ–Ω–∏–ª–∏ –º–æ–¥–µ–ª–∏ Django

1. **–°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ:**
   ```bash
   cd backend
   python manage.py makemigrations
   git add .
   git commit -m "–î–æ–±–∞–≤–∏–ª –Ω–æ–≤—ã–µ –ø–æ–ª—è –≤ –º–æ–¥–µ–ª—å"
   ```

2. **–î–µ–ø–ª–æ–π:**
   ```cmd
   deploy.bat "–û–±–Ω–æ–≤–∏–ª –º–æ–¥–µ–ª–∏ –ë–î"
   ```

3. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```bash
   ssh ubuntu@82.115.48.40
   cd /home/ubuntu/projects/CRM
   docker compose exec backend python manage.py migrate
   ```

---

## –°—Ü–µ–Ω–∞—Ä–∏–π 10: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –≤–æ –≤—Ä–µ–º—è –¥–µ–ø–ª–æ—è

**–¢–µ—Ä–º–∏–Ω–∞–ª 1 (–¥–µ–ø–ª–æ–π):**
```cmd
deploy.bat "–ë–æ–ª—å—à–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ"
```

**–¢–µ—Ä–º–∏–Ω–∞–ª 2 (–ª–æ–≥–∏):**
```cmd
server-logs.bat
```

–¢–∞–∫ –≤—ã —Å—Ä–∞–∑—É —É–≤–∏–¥–∏—Ç–µ –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫.

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
git status
git diff

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
make dev
```

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
ssh ubuntu@82.115.48.40 "cd /home/ubuntu/projects/CRM && docker compose ps"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
ssh ubuntu@82.115.48.40 "cd /home/ubuntu/projects/CRM && docker compose logs --tail=100"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
ssh ubuntu@82.115.48.40 "docker stats --no-stream"
```

### –û—á–∏—Å—Ç–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
ssh ubuntu@82.115.48.40

# –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã
docker system prune -a

# –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
docker compose logs --tail=0

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë
docker compose down
docker compose up -d
```

---

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### –û—à–∏–±–∫–∞: "Permission denied (publickey)"

**–†–µ—à–µ–Ω–∏–µ:**
```cmd
setup-ssh.bat
```

### –û—à–∏–±–∫–∞: "git push rejected"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
git pull --rebase
git push
```

### –û—à–∏–±–∫–∞: "Container failed to start"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
ssh ubuntu@82.115.48.40
cd /home/ubuntu/projects/CRM
docker compose logs
# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É
docker compose up -d
```

### –û—à–∏–±–∫–∞: "Port already in use"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
ssh ubuntu@82.115.48.40
docker compose down
docker compose up -d
```

---

## –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)
- [ ] –ù–µ—Ç console.log –∏ debug –∫–æ–¥–∞
- [ ] .env —Ñ–∞–π–ª—ã –Ω–µ –≤ –∫–æ–º–º–∏—Ç–µ
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω—ã (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã (–µ—Å–ª–∏ –¥–æ–±–∞–≤–ª—è–ª–∏)
- [ ] –ü–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–æ–º–º–∏—Ç–∞

---

## –ß–µ–∫–ª–∏—Å—Ç –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

- [ ] –°–∞–π—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- [ ] –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞
- [ ] API –æ—Ç–≤–µ—á–∞–µ—Ç

---

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ cron (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å (–¥–µ–ø–ª–æ–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3 –Ω–æ—á–∏)
0 3 * * * cd /home/ubuntu/projects/CRM && git pull && docker compose up -d --build
```

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö:

```bash
# –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
#!/bin/bash
if ! docker compose ps | grep -q "Up"; then
    curl -X POST https://api.telegram.org/bot<TOKEN>/sendMessage \
         -d chat_id=<CHAT_ID> \
         -d text="‚ö†Ô∏è –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —É–ø–∞–ª–∏!"
fi
```

---

üìñ **–°–º. —Ç–∞–∫–∂–µ:**
- [DEPLOY.md](../DEPLOY.md) - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- [DEPLOY_CHEATSHEET.md](../DEPLOY_CHEATSHEET.md) - –®–ø–∞—Ä–≥–∞–ª–∫–∞
- [DEPLOY_WINDOWS.md](./DEPLOY_WINDOWS.md) - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Windows
- [DEPLOY_SETUP.md](./DEPLOY_SETUP.md) - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Linux/Mac
