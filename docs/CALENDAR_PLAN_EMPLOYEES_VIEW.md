# Просмотр сотрудников в календарном плане

## Описание

Добавлена возможность просмотра и управления списком сотрудников для каждого участка в календарном плане.

## Функционал

### 1. Раскрывающийся список участков

При клике на кнопку "Детали" в календарном плане отображается список всех участков с:
- Названием участка
- Датами начала и окончания
- Количеством сотрудников
- Кнопкой для раскрытия списка сотрудников

### 2. Просмотр сотрудников

Для каждого участка можно раскрыть список сотрудников, который показывает:
- ФИО сотрудника
- ИИН
- Должность
- Кнопку удаления (только для черновиков)

### 3. Поиск сотрудников

Для участков с более чем 10 сотрудниками автоматически появляется поле поиска:
- Поиск по ФИО
- Поиск по ИИН
- Поиск по должности

### 4. Пагинация

Для больших списков (500+ сотрудников) реализована пагинация:
- Отображается 20 сотрудников на странице
- Навигация между страницами
- Счетчик "Показано X-Y из Z"

### 5. Удаление сотрудников

Для календарных планов в статусе "Черновик":
- Возможность удалить сотрудника из участка
- Подтверждение перед удалением
- Автоматическое обновление списка после удаления

## Технические детали

### Новые состояния

```typescript
const [expandedDepartment, setExpandedDepartment] = useState<string | null>(null);
const [departmentEmployeeSearch, setDepartmentEmployeeSearch] = useState<Record<string, string>>({});
const [departmentEmployeePage, setDepartmentEmployeePage] = useState<Record<string, number>>({});
```

### Новые функции

#### `getEmployeesByIds(employeeIds: string[])`
Получает полную информацию о сотрудниках по их ID из общего списка контингента.

#### `handleRemoveEmployeeFromDepartment(planId, departmentIndex, employeeId)`
Удаляет сотрудника из конкретного участка календарного плана:
1. Находит план и участок
2. Удаляет ID сотрудника из списка
3. Обновляет общий список employeeIds плана
4. Сохраняет изменения через API

## UI/UX особенности

### Адаптивность
- Компактное отображение для малого количества сотрудников
- Автоматическое появление поиска при >10 сотрудниках
- Пагинация для больших списков

### Производительность
- Ленивая загрузка: список сотрудников загружается только при раскрытии
- Пагинация предотвращает рендеринг большого количества элементов
- Поиск работает на клиенте без дополнительных запросов

### Безопасность
- Удаление доступно только для черновиков
- Подтверждение перед удалением
- Валидация прав доступа на backend

## Пример использования

1. Открыть страницу договоров: `/dashboard/clinic/contracts`
2. Найти договор с календарным планом
3. Нажать кнопку "Детали" напротив плана
4. В раскрывшемся списке участков нажать на кнопку с количеством сотрудников
5. Просмотреть список, использовать поиск при необходимости
6. Для черновиков - удалить ненужных сотрудников

## Будущие улучшения

- Массовое удаление сотрудников
- Добавление сотрудников в существующий участок
- Перемещение сотрудников между участками
- Экспорт списка сотрудников в Excel
- Фильтры по должности, вредным факторам
