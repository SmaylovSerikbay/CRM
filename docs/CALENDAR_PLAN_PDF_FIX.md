# Исправление генерации PDF календарного плана

## Проблема
На странице `/dashboard/clinic/calendar-plan` кнопка "Генерировать PDF" не работала - была только заглушка, которая показывала уведомление, но не генерировала и не скачивала файл.

## Решение

### Backend (Django)
Добавлен новый endpoint в `CalendarPlanViewSet` для генерации PDF:

**Endpoint:** `GET /api/calendar-plans/{id}/export_pdf/`

**Функционал:**
- Генерирует PDF документ с использованием библиотеки `reportlab`
- Включает всю информацию о календарном плане:
  - Основная информация (договор, период, количество сотрудников, статус)
  - Информация по участкам (если выбрано несколько)
  - Список вредных факторов
  - Список назначенных врачей
- Возвращает PDF файл для скачивания

**Файл:** `backend/api/views.py`

### Frontend (Next.js/React)
Обновлена функция `handleGeneratePDF` для вызова нового API endpoint:

**Функционал:**
- Вызывает API endpoint для генерации PDF
- Получает blob с PDF файлом
- Автоматически скачивает файл с правильным именем
- Показывает уведомления о процессе и результате

**Файл:** `frontend/app/dashboard/clinic/calendar-plan/page.tsx`

## Использование

1. Перейдите на страницу календарного плана: `/dashboard/clinic/calendar-plan`
2. Найдите нужный календарный план в списке
3. Нажмите кнопку "Генерировать PDF" или "Скачать PDF" (в зависимости от статуса плана)
4. PDF файл автоматически скачается на ваш компьютер

## Формат PDF

PDF документ включает:
- **Заголовок:** "Календарный план медицинских осмотров"
- **Основная информация:** договор, объект/участок, период, количество сотрудников, статус
- **Участки:** таблица с информацией по каждому участку (если их несколько)
- **Вредные факторы:** список выбранных вредных факторов
- **Врачи:** таблица с информацией о назначенных врачах
- **Футер:** дата и время создания документа

## Технические детали

### Зависимости
- Backend: `reportlab` (уже установлен в проекте)
- Frontend: нативный `fetch` API для работы с blob

### Безопасность
- Endpoint использует существующую систему аутентификации
- Доступ к календарному плану проверяется через `get_object()` метод ViewSet

### Обработка ошибок
- Если `reportlab` не установлен, возвращается ошибка 500
- Если план не найден, возвращается ошибка 404
- Все ошибки отображаются пользователю через toast уведомления
