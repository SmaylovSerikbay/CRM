# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìã –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ .env —Ñ–∞–π–ª—ã –¥–ª—è development –∏ production –æ–∫—Ä—É–∂–µ–Ω–∏–π:

- **`.env.dev`** - Development –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- **`.env.prod`** - Production –æ–∫—Ä—É–∂–µ–Ω–∏–µ

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. Development –æ–∫—Ä—É–∂–µ–Ω–∏–µ

–§–∞–π–ª `.env.dev` —É–∂–µ —Å–æ–∑–¥–∞–Ω —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:

```bash
# –ó–∞–ø—É—Å–∫ —Å .env.dev
make dev
# –∏–ª–∏
docker-compose -f docker-compose.dev.yml up
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `crm_db_dev`
- –ü–∞—Ä–æ–ª—å –ë–î: `postgres` (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ, —Ç–æ–ª—å–∫–æ –¥–ª—è dev!)
- DEBUG: `True`
- Secret Key: –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–ª—é—á –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### 2. Production –æ–∫—Ä—É–∂–µ–Ω–∏–µ

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –≤ production **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env.prod`:

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
notepad .env.prod  # Windows
nano .env.prod     # Linux/Mac
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:**

1. **POSTGRES_PASSWORD** - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å
2. **SECRET_KEY** - –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á
3. **ALLOWED_HOSTS** - –î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω
4. **GREEN_API_*** - –í–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Green API (–µ—Å–ª–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è)

```bash
# –ó–∞–ø—É—Å–∫ —Å .env.prod
make prod
# –∏–ª–∏
docker-compose up
```

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ .env —Ñ–∞–π–ª–æ–≤

### .env.dev (Development)

```env
# PostgreSQL Database
POSTGRES_DB=crm_db_dev
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=db
POSTGRES_PORT=5432

# Django Backend
SECRET_KEY=django-insecure-dev-key-only-for-development
DEBUG=True
ALLOWED_HOSTS=*

# Green API (WhatsApp OTP)
GREEN_API_ID_INSTANCE=7105394320
GREEN_API_TOKEN=6184c77e6f374ddc8003957d0d3f4ccc7bc1581c600847d889
GREEN_API_URL=https://7105.api.green-api.com

# Frontend
NEXT_PUBLIC_API_URL=http://localhost:8001/api
NODE_ENV=development
```

### .env.prod (Production)

```env
# PostgreSQL Database
POSTGRES_DB=crm_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=change_this_secure_password_in_production  # ‚ö†Ô∏è –ò–ó–ú–ï–ù–ò–¢–¨!
POSTGRES_HOST=db
POSTGRES_PORT=5432

# Django Backend
SECRET_KEY=change-this-to-a-secure-random-key-in-production  # ‚ö†Ô∏è –ò–ó–ú–ï–ù–ò–¢–¨!
DEBUG=False
ALLOWED_HOSTS=localhost,127.0.0.1,your-domain.com  # ‚ö†Ô∏è –ò–ó–ú–ï–ù–ò–¢–¨!

# Green API (WhatsApp OTP)
GREEN_API_ID_INSTANCE=7105394320  # ‚ö†Ô∏è –ü–†–û–í–ï–†–ò–¢–¨!
GREEN_API_TOKEN=6184c77e6f374ddc8003957d0d3f4ccc7bc1581c600847d889  # ‚ö†Ô∏è –ü–†–û–í–ï–†–ò–¢–¨!
GREEN_API_URL=https://7105.api.green-api.com

# Frontend
NEXT_PUBLIC_API_URL=http://localhost:8000/api  # ‚ö†Ô∏è –ò–ó–ú–ï–ù–ò–¢–¨ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω!
NODE_ENV=production
```

## üîë –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SECRET_KEY

### –°–ø–æ—Å–æ–± 1: Python

```bash
python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
```

### –°–ø–æ—Å–æ–± 2: Online –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: https://djecrety.ir/

### –°–ø–æ—Å–æ–± 3: OpenSSL

```bash
openssl rand -base64 50
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å:

1. **–í—Å–µ–≥–¥–∞ –∏–∑–º–µ–Ω—è–π—Ç–µ** –ø–∞—Ä–æ–ª–∏ –∏ –∫–ª—é—á–∏ –≤ production
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏** (–º–∏–Ω–∏–º—É–º 16 —Å–∏–º–≤–æ–ª–æ–≤)
3. **–ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ** .env —Ñ–∞–π–ª—ã –≤ Git (–æ–Ω–∏ –≤ .gitignore)
4. **–•—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏** .env —Ñ–∞–π–ª–æ–≤ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
5. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ ALLOWED_HOSTS** —Ç–æ–ª—å–∫–æ –≤–∞—à–∏–º–∏ –¥–æ–º–µ–Ω–∞–º–∏

### ‚ùå –ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å:

1. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ** –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –≤ production
2. **–ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ** .env —Ñ–∞–π–ª—ã –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ
3. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ** DEBUG=True –≤ production
4. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ** ALLOWED_HOSTS=* –≤ production
5. **–ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ** —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥–µ

## üìä –†–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Development (.env.dev) | Production (.env.prod) |
|----------|------------------------|------------------------|
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | crm_db_dev | crm_db |
| –ü–∞—Ä–æ–ª—å –ë–î | postgres | –ù–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å |
| DEBUG | True | False |
| ALLOWED_HOSTS | * | –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–æ–º–µ–Ω—ã |
| SECRET_KEY | –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π | –°–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á |
| Frontend URL | localhost:8001 | –í–∞—à –¥–æ–º–µ–Ω |
| Backend —Å–µ—Ä–≤–µ—Ä | runserver | gunicorn |

## üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

### Development ‚Üí Production

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å dev
make down-dev

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env.prod
nano .env.prod

# –ó–∞–ø—É—Å—Ç–∏—Ç—å prod
make prod
```

### Production ‚Üí Development

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å prod
make down-prod

# –ó–∞–ø—É—Å—Ç–∏—Ç—å dev
make dev
```

## üõ†Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è

```bash
# Development
docker-compose -f docker-compose.dev.yml config

# Production
docker-compose config
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

```bash
# Development
docker-compose exec backend env | grep POSTGRES
docker-compose exec backend env | grep DEBUG

# Production
docker-compose exec backend env | grep POSTGRES
docker-compose exec backend env | grep DEBUG
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env.dev` –∫–∞–∫ –µ—Å—Ç—å:
```bash
make dev
```

### Staging —Å–µ—Ä–≤–µ—Ä

–°–æ–∑–¥–∞–π—Ç–µ `.env.staging`:
```bash
cp .env.prod .env.staging
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è staging
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ñ–∞–π–ª–æ–º:
```bash
docker-compose --env-file .env.staging up
```

### Production —Å–µ—Ä–≤–µ—Ä

1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env.prod`
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
3. –£–∫–∞–∂–∏—Ç–µ –≤–∞—à –¥–æ–º–µ–Ω
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
make prod
```

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ù—É–∂–Ω–æ –ª–∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å .env —Ñ–∞–π–ª—ã –≤—Ä—É—á–Ω—É—é?

A: –ù–µ—Ç, —Ñ–∞–π–ª—ã `.env.dev` –∏ `.env.prod` —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã. –ù–æ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env.prod` –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤ production!

### Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ –∑–∞–±—ã–ª –ø–∞—Ä–æ–ª—å –ë–î?

A: 
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å volumes
make clean

# –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ .env —Ñ–∞–π–ª–µ
nano .env.prod

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
make prod
```

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω .env –¥–ª—è –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π?

A: –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è. –†–∞–∑–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### Q: –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å .env —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ?

A: –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞, –Ω–æ —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –æ–Ω–∏:
- –ù–µ –≤ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –ò–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (600)
- –ï—Å—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ

### Q: –ö–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞?

A: –ù–µ–ª—å–∑—è. –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è .env —Ñ–∞–π–ª–æ–≤ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:
```bash
make restart-prod  # –∏–ª–∏ make restart-dev
```

## üîó –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- [README.md](./README.md) - –ì–ª–∞–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [MIGRATION_GUIDE.md](./MIGRATION_GUIDE.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
- [backend/.env.example](./backend/.env.example) - –ü—Ä–∏–º–µ—Ä –¥–ª—è backend
- [frontend/.env.example](./frontend/.env.example) - –ü—Ä–∏–º–µ—Ä –¥–ª—è frontend

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

1. **–ü–µ—Ä–µ–¥ production:** –ò–∑–º–µ–Ω–∏—Ç–µ –≤—Å–µ –ø–∞—Ä–æ–ª–∏ –∏ –∫–ª—é—á–∏ –≤ `.env.prod`
2. **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏:** –•—Ä–∞–Ω–∏—Ç–µ –∫–æ–ø–∏–∏ .env —Ñ–∞–π–ª–æ–≤ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
3. **–ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ:** .env —Ñ–∞–π–ª—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–æ–ø–∞—Å—Ç—å –≤ Git
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:** –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –≤ production

---

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ! üîí**
