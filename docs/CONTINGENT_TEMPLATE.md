# Шаблон для загрузки контингента

## Описание

Шаблон Excel для загрузки списка сотрудников, подлежащих обязательному медицинскому осмотру, с автоматическими выпадающими списками для полей "Пол" и "Профессиональная вредность".

## Структура шаблона

### Основной лист: "Список контингента"

Содержит следующие колонки:

1. **№ п/п** - порядковый номер
2. **ФИО** - полное имя сотрудника
3. **Дата рождения** - в формате ДД.ММ.ГГГГ
4. **Пол** - выпадающий список (мужской/женский)
5. **Объект или участок** - место работы
6. **Занимаемая должность** - должность сотрудника
7. **Общий стаж** - общий трудовой стаж
8. **Стаж по занимаемой должности** - стаж на текущей должности
9. **Дата последнего медосмотра** - дата в формате ДД.ММ.ГГГГг
10. **Профессиональная вредность** - выпадающий список (см. ниже)
11. **Примечание** - дополнительная информация

### Справочные листы (скрыты)

#### Ref_Gender - Справочник полов
- мужской
- женский

#### Ref_Harm - Справочник профессиональных вредностей

Согласно приказу и.о. Министра здравоохранения Республики Казахстан от 15 октября 2020 года № ҚР ДСМ-131/2020:

- п.1 «Работы, связанные с воздействием химических факторов»
- п.2 «Работы с канцерогенными веществами»
- п.3 «Работы с пестицидами и агрохимикатами»
- п.4 «Работы, связанные с воздействием биологических факторов»
- п.5 «Работы, выполняемые в условиях повышенного шума»
- п.6 «Работы, выполняемые в условиях вибрации»
- п.7 «Работы, выполняемые в условиях ионизирующего излучения»
- п.8 «Работы, выполняемые в условиях неионизирующих излучений»
- п.9 «Работы, выполняемые при повышенной или пониженной температуре воздуха»
- п.10 «Работы в замкнутых пространствах»
- п.11 «Работы на высоте»
- п.12 «Работы, связанные с подъемом и перемещением тяжестей»
- п.13 «Работы в ночное время»
- п.14 «Работа на ПК»
- п.15 «Работы, связанные с эмоциональным и умственным перенапряжением»
- п.16 «Работы, связанные с повышенной ответственностью»
- п.17 «Работы вахтовым методом»
- п.18 «Подземные работы»
- п.19 «Работы на транспорте»
- п.20 «Работы, связанные с воздействием пыли»
- п.21 «Работы с горюче-смазочными материалами»
- п.22 «Работы, связанные с воздействием нефти и нефтепродуктов»
- п.23 «Работы в условиях повышенной загазованности»
- п.24 «Работы в условиях недостатка кислорода»
- п.25 «Работы в условиях повышенной влажности»
- п.26 «Работы, связанные с виброинструментом»
- п.27 «Работы на конвейерах»
- п.28 «Работы на строительных площадках»
- п.29 «Работы в металлургическом производстве»
- п.30 «Работы в горнодобывающей промышленности»
- п.31 «Работы в деревообрабатывающем производстве»
- п.32 «Работы в текстильной и швейной промышленности»
- п.33 «Профессии и работы»

## Как использовать

### 1. Скачивание шаблона

В разделе "Контингент" нажмите кнопку "Скачать шаблон Excel".

### 2. Заполнение данных

1. Откройте скачанный файл в Microsoft Excel
2. Начните заполнять данные с 5-й строки (после заголовков)
3. Для полей "Пол" и "Профессиональная вредность" используйте выпадающие списки:
   - Кликните на ячейку
   - Появится стрелка справа
   - Выберите нужное значение из списка

### 3. Загрузка файла

1. Сохраните заполненный файл
2. В разделе "Контингент" нажмите "Загрузить Excel"
3. Выберите ваш файл
4. Система автоматически обработает данные

## Важные замечания

- **Не удаляйте** справочные листы (Ref_Gender, Ref_Harm) - они скрыты, но необходимы для работы выпадающих списков
- **Не изменяйте** заголовки колонок
- **Используйте** выпадающие списки вместо ручного ввода для полей "Пол" и "Профессиональная вредность"
- Дата рождения должна быть в формате: ДД.ММ.ГГГГ (например, 29.03.1976)
- Дата последнего медосмотра должна быть в формате: ДД.ММ.ГГГГг (например, 22.01.2024г)

## Просмотр скрытых листов (опционально)

Если вам нужно увидеть справочные листы:

1. Правой кнопкой мыши на любой вкладке листа
2. Выберите "Показать"
3. Выберите нужный лист (Ref_Gender или Ref_Harm)

## Техническая информация

### Реализация

Выпадающие списки реализованы с использованием:
- **Data Validation** в openpyxl
- **Именованные диапазоны** на скрытых листах
- **Формулы** типа `=Ref_Gender!$A$1:$A$2`

### Преимущества подхода

1. **Надежность** - работает во всех версиях Excel
2. **Локализация** - не зависит от языковых настроек Excel
3. **Расширяемость** - легко добавить новые значения в справочники
4. **Удобство** - пользователь видит только основной лист

## Устранение неполадок

### Выпадающие списки не работают

1. Убедитесь, что файл открыт в Microsoft Excel (не в Google Sheets или LibreOffice)
2. Проверьте, что справочные листы не были удалены
3. Попробуйте скачать шаблон заново

### Ошибка при загрузке

1. Проверьте, что все обязательные поля заполнены
2. Убедитесь, что даты в правильном формате
3. Проверьте, что значения в полях "Пол" и "Профессиональная вредность" выбраны из списка

## Пример заполнения

| № п/п | ФИО | Дата рождения | Пол | Объект или участок | Занимаемая должность | Общий стаж | Стаж по должности | Дата последнего медосмотра | Профессиональная вредность | Примечание |
|-------|-----|---------------|-----|-------------------|---------------------|-----------|------------------|---------------------------|---------------------------|-----------|
| 1 | Иванов Иван Иванович | 29.03.1976 | мужской | ТОО "Компания" - Отдел | Оператор | 20 | 18 | 22.01.2024г | п.33 «Профессии и работы» | |
| 2 | Петрова Мария Петровна | 15.05.1985 | женский | ТОО "Компания" - Офис | Бухгалтер | 15 | 10 | 24.01.2024г | п.14 «Работа на ПК» | |
